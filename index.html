// 数値取得（列がなくても0）
const v = (row, name) => Number(row[idx[name]] || 0);

// 商品名
const name = r[idx["商品名"]] || "";

// 東京
const tokyo =
  v(r,"東京空き段ボール") -
  (
    v(r,"東京入庫破損") +
    v(r,"東京返品（JP都合）") +
    v(r,"東京代替戻り（ダイワ都合）") +
    v(r,"不具合品（東京倉庫）") +
    v(r,"倉庫内破損（東京倉庫）")
  );

// 大阪（新大阪）
const osaka =
  v(r,"新大阪空き段ボール") -
  (
    v(r,"新大阪入庫破損") +
    v(r,"新大阪代替戻（返品）") +
    v(r,"不具合品（新大阪倉庫）") +
    v(r,"倉庫内破損（新大阪倉庫）")
  );

// 名古屋
const nagoya =
  v(r,"新名古屋空き段ボール") -
  (
    v(r,"新名古屋入庫破損") +
    v(r,"新名古屋返品（JP都合）") +
    v(r,"新名古屋代替戻り（名港都合）") +
    v(r,"不具合品（新名古屋倉庫）") +
    v(r,"倉庫内破損（新名古屋倉庫）")
  );

// 福岡
const fukuoka =
  v(r,"福岡空き段ボール") -
  (
    v(r,"福岡入庫破損") +
    v(r,"福岡返品（JP都合）") +
    v(r,"福岡代替戻り（倉庫都合）") +
    v(r,"不具合品（福岡倉庫）") +
    v(r,"倉庫内破損（福岡倉庫）")
  );

// 龍ヶ崎
const ryugasaki =
  v(r,"龍ケ崎空き段ボール") -
  (
    v(r,"龍ケ崎入庫破損") +
    v(r,"龍ケ崎返品") +
    v(r,"不具合品（龍ケ崎倉庫）") +
    v(r,"倉庫内破損（龍ケ崎倉庫）")
  );

// 北海道
const hokkaido =
  v(r,"北海道空き段ボール") -
  (
    v(r,"北海道入庫破損") +
    v(r,"北海道返品（JP都合）") +
    v(r,"北海道代替戻り（倉庫都合）") +
    v(r,"不具合品（北海道倉庫）") +
    v(r,"倉庫内破損（北海道倉庫）")
  );

