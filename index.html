<script>
document.getElementById("csvFile").addEventListener("change", function(e) {

  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();

  reader.onload = function() {
    const lines = reader.result.split(/\r?\n/);
    const tbody = document.querySelector("#resultTable tbody");
    tbody.innerHTML = "";

    for (let i = 1; i < lines.length; i++) {
      if (!lines[i]) continue;

      const c = lines[i].split(",");

      const name = c[2] || "";

      const tokyo =
        (+c[8] || 0) - ((+c[5] || 0) + (+c[6] || 0) + (+c[7] || 0) + (+c[11] || 0) + (+c[12] || 0));

      const osaka =
        (+c[18] || 0) - ((+c[15] || 0) + (+c[17] || 0) + (+c[20] || 0) + (+c[21] || 0));

      const nagoya =
        (+c[27] || 0) - ((+c[24] || 0) + (+c[25] || 0) + (+c[28] || 0) + (+c[29] || 0));

      const fukuoka =
        (+c[35] || 0) - ((+c[32] || 0) + (+c[33] || 0) + (+c[36] || 0) + (+c[37] || 0));

      const ryugasaki =
        (+c[42] || 0) - ((+c[40] || 0) + (+c[41] ||
