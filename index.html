<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>空箱発注チェック</title>

<style>
body {
  font-family: Arial, sans-serif;
  padding: 20px;
}

table {
  border-collapse: collapse;
  margin-top: 20px;
  width: 100%;
}

th, td {
  border: 1px solid #ccc;
  padding: 6px 8px;
  text-align: center;
}

th {
  background: #f0f0f0;
}

.need-red {
  background: #ffe5e5;
  color: #b00000;
  font-weight: bold;
}

.need-orange {
  background: #fff3cd;
  color: #8a6d3b;
  font-weight: bold;
}
</style>
</head>

<body>

<h2>空箱発注チェック</h2>

<input type="file" id="csvFile" accept=".csv">

<table id="result">
  <thead>
    <tr>
      <th>商品名</th>
      <th>東京</th>
      <th>大阪</th>
      <th>名古屋</th>
      <th>福岡</th>
      <th>龍ヶ崎</th>
      <th>北海道</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const fileInput = document.getElementById("csvFile");
const tbody = document.querySelector("#result tbody");

// ヘッダー正規化（空白・全角対策）
const norm = s => s.replace(/\s/g, "").trim();

// CSV読み込み
fileInput.addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = () => parseCSV(reader.result);
  reader.readAsText(file, "UTF-8");
});

function parseCSV(text) {
  tbody.innerHTML = "";

  const rows = text.trim().split(/\r?\n/).map(r => r.split(","));
  const headers = rows[0];

  // ヘッダー → index
  const idx = {};
  headers.forEach((h, i) => idx[norm(h)] = i);

  // 値取得（列が無ければ0）
  const v = (row, name) => {
    const i = idx[norm(name)];
    return i
